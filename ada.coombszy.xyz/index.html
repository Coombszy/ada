<!DOCTYPE html>
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script>
    
$(document).ready(function(){
    console.log("DOC LOAD");

    window.onload = init;
    var context;    // Audio context
    var buf;        // Audio buffer

    function init() {
        if (!window.AudioContext) {
        if (!window.webkitAudioContext) {
            alert("Your browser does not support any AudioContext and cannot play back this audio.");
            return;
        }
            window.AudioContext = window.webkitAudioContext;
        }

        context = new AudioContext();
    }

    function playByteArray(byteArray) {

        var arrayBuffer = new ArrayBuffer(byteArray.length);
        var bufferView = new Uint8Array(arrayBuffer);
        for (i = 0; i < byteArray.length; i++) {
        bufferView[i] = byteArray[i];
        }

        context.decodeAudioData(arrayBuffer, function(buffer) {
            buf = buffer;
            play();
        });
    }

    // Play the loaded file
    function play() {
        // Create a source node from the buffer
        var source = context.createBufferSource();
        source.buffer = buf;
        // Connect to the final output node (the speakers)
        source.connect(context.destination);
        // Play immediately
        source.start(0);
    }



    
    $("button").click(function(){
        $.ajax({
            type: "POST",
            crossOrigin: true,
            url: "http://localhost:40401",
            data: JSON.stringify({"adaQuery": "hello world"}),
            dataType: "json",
            success: function(data) {
                console.log("PASS");
                console.log(data);
                //playByteArray(JSON.parse(data).adaQueryVoiceBytes);
            },
            error: function(xhr, status, error) {
                console.log("FAIL");
                console.log(xhr);
                console.log(status);
                console.log(error);
            }
        });
    });

});

</script>
</head>
<body>

<button>Send Data</button>

</body>
</html>